<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DAX BACI | Monthly Trades</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      background-color: #000;
      color: #fff;
    }
    .text-purple-gradient {
      background-image: linear-gradient(90deg, #D444F8 0%, #6A3896 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* Background gradient */
    .gradient-bg {
      background-color: #000;
      position: relative;
      overflow: hidden;
    }
    .gradient-bg::before {
      content: '';
      position: fixed;
      bottom: 20%;
      left: 0;
      width: 800px;
      height: 800px;
      background: radial-gradient(circle, rgba(128, 90, 213, 0.45) 0%, transparent 90%);
      transform: translate(-50%, 50%);
      pointer-events: none;
      z-index: 0;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #1a1a1a; }
    ::-webkit-scrollbar-thumb {
      background-color: #6A3896;
      border-radius: 4px;
    }

    /* Nav menu */
    .nav-menu {
      font-size: 17px;
      font-weight: 500;
      line-height: 1.8em;
      color: #e6e6e699;
      font-family: 'Plus Jakarta Sans', sans-serif;
      backdrop-filter: blur(40px);
      background-color: #47474780;
      border-radius: .76em;
      padding: .35em;
      display: flex;
      gap: 4px;
      align-items: center;
    }
    .nav-link {
      color: #e6e6e6;
      text-decoration: none;
      padding: 8px 12px;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .nav-link:hover {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 0.5em;
    }
    .nav-link img {
      width: 20px;
      height: 20px;
    }

    /* Get Deals button */
    .get-deals-btn {
      position: relative;
      overflow: hidden;
      transition: all 0.7s ease-in-out;
    }
    .get-deals-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(to right, transparent, rgba(128, 90, 213, 0.3), transparent);
      transition: left 0.7s ease-in-out;
      transform: skewX(-20deg);
    }
    .get-deals-btn:hover {
      background-color: #473274;
    }
    .get-deals-btn:hover::before {
      left: 100%;
    }

    /* Hamburger */
    .hamburger-menu {
      display: none;
      flex-direction: column;
      justify-content: space-between;
      width: 18px;
      height: 14px;
      cursor: pointer;
    }
    .hamburger-menu span {
      display: block;
      height: 2px;
      background-color: white;
      transition: all 0.3s ease-in-out;
    }
    .hamburger-menu.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }
    .hamburger-menu.active span:nth-child(2) { opacity: 0; }
    .hamburger-menu.active span:nth-child(3) {
      transform: rotate(-45deg) translate(5px, -5px);
    }

    /* Mobile nav */
    #mobile-nav {
      position: fixed;
      top: 0;
      right: 0;
      width: 66.66%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-end;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      z-index: 40;
      padding: 1.5rem;
    }
    #mobile-nav.active { transform: translateX(0); }
    #mobile-nav .nav-link {
      padding: 1.25rem 0;
      font-size: 1rem;
      width: 100%;
      justify-content: flex-end;
    }
    #mobile-nav .nav-link img {
      width: 1rem;
      height: 1rem;
    }

    /* Trade cards */
    .trade-card {
      background: #000;
      border: 1px solid #6A3896;
      border-radius: 5px;
      padding: 24px;
    }
    .trade-pair {
      font-size: 40px;
      font-weight: 700;
      color: #fff;
    }
    .trade-status {
      font-size: 24px;
      font-weight: 700;
    }

    /* iPhone-style Toggle Switch */
    .toggle-container {
      display: flex;
      align-items: center;
      gap: 12px;
      justify-content: center;
    }
    
    .toggle-switch {
      position: relative;
      width: 48px;
      height: 28px;
      background-color: #374151;
      border-radius: 14px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    
    .toggle-switch.inactive {
      background-color: #34d399;
    }
    
    .toggle-switch::after {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 24px;
      height: 24px;
      background-color: white;
      border-radius: 50%;
      transition: transform 0.3s ease;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .toggle-switch.inactive::after {
      transform: translateX(20px);
    }
    
    .toggle-label {
      font-size: 14px;
      font-weight: 500;
      color: #9ca3af;
      user-select: none;
    }

    /* Responsive rules */
    @media (max-width: 1000px) {
      .nav-menu { display: none; }
      .hamburger-menu { display: flex; }
      #trades-container { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body class="bg-black text-white gradient-bg overflow-y-auto">

  <header class="fixed top-0 w-full z-50 flex justify-between items-center px-6 py-4 pt-6">
    <a href="/" class="text-xl md:text-2xl lg:text-3xl font-bold text-white tracking-wide">
      DAX BACIüßë‚Äçüç≥
    </a>

    <nav role="navigation" class="nav-menu text-sm">
      <a href="https://www.x.com/thissdax" class="nav-link">
        <img src="images/icons/x.png" alt="X"> X (Twitter)
      </a>
      <a href="https://www.instagram.com/thissdax/?hl=en" class="nav-link">
        <img src="images/icons/instagram.png" alt="Instagram"> Instagram
      </a>
      <a href="https://t.me/thedaxbrand" class="nav-link">
        <img src="images/icons/telegram.png" alt="Telegram"> Telegram
      </a>
      <a href="/deals" class="nav-link get-deals-btn">
        <img src="images/icons/flash.png" alt="Deals">
        <span>GET DEALS NOW</span>
      </a>
    </nav>

    <button id="hamburger-menu" class="hamburger-menu lg:hidden">
      <span></span><span></span><span></span>
    </button>

    <nav id="mobile-nav" class="lg:hidden">
      <div class="flex flex-col items-end w-full space-y-4">
        <a href="https://www.x.com/thissdax" class="nav-link">
          <img src="images/icons/x.png" alt="X"> X (Twitter)
        </a>
        <a href="https://www.instagram.com/thissdax/?hl=en" class="nav-link">
          <img src="images/icons/instagram.png" alt="Instagram"> Instagram
        </a>
        <a href="https://t.me/thedaxbrand" class="nav-link">
          <img src="images/icons/telegram.png" alt="Telegram"> Telegram
        </a>
        <a href="/deals" class="nav-link get-deals-btn">
          <img src="images/icons/flash.png" alt="Deals">
          <span>GET DEALS NOW</span>
        </a>
      </div>
    </nav>
  </header>

  <main class="container mx-auto px-4 lg:px-8 mt-24" style="max-width:1200px;">
    <a href="index.html" class="flex items-center text-gray-400 hover:text-white transition-colors mb-8">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
      </svg>
      <span class="text-sm font-bold">SEE ALL MONTHS</span>
    </a>

    <h2 id="month-title" class="text-6xl md:text-5xl lg:text-6xl font-bold text-white mb-6"></h2>

    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4 text-left text-sm font-bold mb-12">
      <div class="border-l border-gray-700 pl-8">
        <span class="text-gray-400 block">PROFIT</span>
        <span id="profit-summary" class="text-2xl font-bold mt-1 text-purple-gradient"></span>
      </div>
      <div class="border-l border-gray-700 pl-8">
        <span class="text-gray-400 block">SETUPS</span>
        <span id="trades-summary" class="text-2xl font-bold mt-1"></span>
      </div>
      <div class="border-l border-gray-700 pl-8">
        <span class="text-gray-400 block">WINRATE</span>
        <span id="winrate-summary" class="text-2xl font-bold mt-1"></span>
      </div>
      <div class="border-l border-gray-700 pl-8">
        <span class="text-gray-400 block">WINS</span>
        <span id="wins-summary" class="text-2xl font-bold mt-1"></span>
      </div>
    </div>

    <div id="trades-container" class="grid grid-cols-2 gap-8 justify-center"></div>
  </main>

  <footer class="text-center text-gray-500 text-sm py-6 mt-12">
    <div class="toggle-container mb-4">
      <span class="toggle-label">Show All</span>
      <div id="filter-toggle" class="toggle-switch" data-active="true">
      </div>
      <span class="toggle-label">Wins & Losses Only</span>
    </div>
    <div>Footer for Now</div>
  </footer>

  <script src="data/trades.js"></script>
  <script>
    const tradesContainer = document.getElementById('trades-container');
    const monthTitle = document.getElementById('month-title');
    const profitSummary = document.getElementById('profit-summary');
    const tradesSummary = document.getElementById('trades-summary');
    const winrateSummary = document.getElementById('winrate-summary');
    const winsSummary = document.getElementById('wins-summary');
    const filterToggle = document.getElementById('filter-toggle');
    
    let isFilterActive = true; // Default to showing only wins/losses
    let currentTrades = [];
    let currentMonth = '';

    // Toggle functionality
    filterToggle.addEventListener('click', function() {
      isFilterActive = !isFilterActive;
      this.classList.toggle('inactive');
      this.dataset.active = isFilterActive;
      renderTrades();
    });

    // Filter trades based on toggle state
    const getFilteredTrades = (trades) => {
      if (!isFilterActive) {
        return trades; // Show all trades
      }
      return trades.filter(trade => trade.status === 'WIN' || trade.status === 'LOSS');
    };

    // Create trade card
    const createTradeCard = (trade, month, originalIndex) => {
      const cardLink = document.createElement('a');
      cardLink.href = `/${month}/${originalIndex}`;
      cardLink.classList = 'block trade-card hover:bg-gray-900 transition-colors cursor-pointer';

      let statusColor = '';
      if (trade.status === 'WIN') statusColor = 'text-[#84f181]';
      else if (trade.status === 'LOSS') statusColor = 'text-[#f18181]';
      else if (trade.status === 'ACTIVE') statusColor = 'text-[#f1c440]';
      else statusColor = 'text-[#D9D9D9]';

      let profitColor = 'text-[#D9D9D9]';
      let profitText = '--';
      if (trade.profit && trade.profit !== '--') {
        profitText = trade.profit;
        profitColor = trade.profit.startsWith('-') ? 'text-[#f18181]' : 'text-[#84f181]';
      }

      const recordsCount = trade.telegramLinks ? trade.telegramLinks.length : 0;

      cardLink.innerHTML = `
        <div class="flex items-center justify-between mb-4">
          <span class="trade-pair">${trade.pair}</span>
          <span class="trade-status ${statusColor}">${trade.status.toUpperCase()}</span>
        </div>
        <div class="flex items-center justify-between text-sm font-bold">
          <div class="text-gray-400">PROFIT: <span class="${profitColor}">${profitText}</span></div>
          <div class="text-gray-400">RECORDS: <span class="text-white">${recordsCount}</span></div>
        </div>
      `;
      return cardLink;
    };

    // Stats calculation (always based on all trades for accuracy)
    const calculateStats = (allTrades) => {
      const completedTrades = allTrades.filter(trade =>
        trade.status !== 'ACTIVE' &&
        trade.status !== 'CANCELLED' &&
        trade.status !== 'UNTRIGGERED' &&
        trade.status !== 'AWAITING' &&
        trade.status !== 'RUNNING'
      );
      const totalTrades = completedTrades.length;
      const wins = completedTrades.filter(t => t.status === 'WIN').length;
      const losses = completedTrades.filter(t => t.status === 'LOSS').length;
      const winrate = (wins + losses) === 0 ? 0 : Math.round((wins / (wins + losses)) * 100).toFixed(0);
      const totalProfit = completedTrades.reduce((sum, t) => {
        if (t.profit === '--' || !t.profit) return sum;
        return sum + parseFloat(t.profit.replace('R', ''));
      }, 0);
      return { totalTrades, wins, winrate, totalProfit: totalProfit.toFixed(2) };
    };

    // Render trades (filtered based on toggle)
    const renderTrades = () => {
      if (!currentTrades.length) return;
      
      const filteredTrades = getFilteredTrades(currentTrades);
      
      tradesContainer.innerHTML = '';
      filteredTrades.forEach((trade, i) => {
        // Find original index for correct routing
        const originalIndex = currentTrades.findIndex(t => t === trade);
        tradesContainer.appendChild(createTradeCard(trade, currentMonth, originalIndex));
      });
    };

    // Main render function
    const renderPage = () => {
      const pathSegments = window.location.pathname.split('/').filter(segment => segment);
      const month = pathSegments.length > 0 ? pathSegments[0] : null;

      if (!month || !monthlyTrades[month]) {
        monthTitle.textContent = 'Month Not Found';
        tradesContainer.innerHTML = '<div class="text-center text-gray-400 col-span-2">No trades found for this month.</div>';
        return;
      }
      
      currentTrades = monthlyTrades[month];
      currentMonth = month;
      monthTitle.textContent = month.toUpperCase();
      
      // Stats are always calculated from all trades
      const stats = calculateStats(currentTrades);
      profitSummary.textContent = `${stats.totalProfit}R`;
      tradesSummary.textContent = stats.totalTrades;
      winrateSummary.textContent = `${stats.winrate}%`;
      winsSummary.textContent = stats.wins;

      const profitValue = parseFloat(stats.totalProfit);
      if (profitValue > 0) profitSummary.className = 'text-2xl font-bold mt-1 text-green-400';
      else if (profitValue < 0) profitSummary.className = 'text-2xl font-bold mt-1 text-red-400';
      else profitSummary.className = 'text-2xl font-bold mt-1 text-gray-400';

      renderTrades();
    };

    document.addEventListener('DOMContentLoaded', () => {
      renderPage();

        // Sync toggle UI with logic
    if (isFilterActive) {
      filterToggle.classList.add('inactive');  // knob to the right (green)
    } else {
      filterToggle.classList.remove('inactive'); // knob to the left (gray)
    }
    
      const hamburger = document.getElementById('hamburger-menu');
      const mobileNav = document.getElementById('mobile-nav');

      hamburger.addEventListener('click', function() {
        this.classList.toggle('active');
        mobileNav.classList.toggle('active');
      });

      // Close mobile menu when clicking outside
      document.addEventListener('click', function(event) {
        const isClickInside = mobileNav.contains(event.target) || hamburger.contains(event.target);
        if (!isClickInside && mobileNav.classList.contains('active')) {
          hamburger.classList.remove('active');
          mobileNav.classList.remove('active');
        }
      });
    });
  </script>
</body>
</html>